<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>My Appointments</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gray-100">

<div class="max-w-4xl mx-auto mt-10 bg-white shadow-lg rounded-lg p-6">
    <h2 class="text-2xl font-bold text-blue-900 mb-4">ğŸ“… My Appointments</h2>

    {% if appointments %}
        <div class="space-y-4">
            {% for ap in appointments %}

                <div class="border p-4 rounded-lg bg-gray-50 hover:bg-gray-100 transition">

                    <div class="flex justify-between items-start">

                        <div>
                            <h3 class="font-bold text-xl text-blue-700">
                                Dr. {{ ap.doctor.user.first_name }} {{ ap.doctor.user.last_name }}
                            </h3>

                            <p class="text-gray-700 mt-1">
                                ğŸ¥ Hospital:
                                <span class="font-medium">{{ ap.hospital.name }}</span>
                            </p>

                            <p class="text-gray-700">ğŸ“… Date: {{ ap.appointment_date }}</p>
                            <p class="text-gray-700">â° Time: {{ ap.appointment_time }}</p>

                            {% if ap.symptoms %}
                                <p class="text-gray-700">ğŸ“ Symptoms: {{ ap.symptoms }}</p>
                            {% endif %}

                            <p class="text-gray-400 text-sm mt-2">
                                Created at: {{ ap.created_at }}
                            </p>
                        </div>

                        <!-- Status and Cancel -->
                        <div class="flex flex-col items-end gap-3">

                            <!-- Status Badge -->
                            {% if ap.status == "Confirmed" %}
                                <span class="bg-green-600 text-white px-3 py-1 rounded-full text-sm">
                                    âœ” Confirmed
                                </span>
                            {% elif ap.status == "Rejected" %}
                                <span class="bg-red-600 text-white px-3 py-1 rounded-full text-sm">
                                    âœ– Rejected
                                </span>
                            {% else %}
                                <span class="bg-yellow-500 text-white px-3 py-1 rounded-full text-sm">
                                    â³ Pending
                                </span>
                            {% endif %}

                            <!-- Cancel Button (only if Pending or Confirmed) -->
                            {% if ap.status != "Rejected" %}
                            <a 
                                href="{% url 'CancelAppointments' ap.id %}"
                                onclick="return confirm('Are you sure you want to cancel this appointment?')"
                                class="bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg shadow"
                            >
                                Cancel
                            </a>
                            {% endif %}

                        </div>

                    </div>
                </div>

            {% endfor %}
        </div>

    {% else %}
        <p class="text-gray-600 mt-4">You have no appointments yet.</p>
    {% endif %}
</div>

</body>
</html>
